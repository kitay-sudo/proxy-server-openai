# üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π
node --version
npm --version

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx
sudo apt install nginx -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
sudo npm install -g pm2

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç
sudo apt install curl wget git -y
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Node.js
node --version  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v20.x.x

# –ü—Ä–æ–≤–µ—Ä–∫–∞ npm
npm --version   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 10.x.x

# –ü—Ä–æ–≤–µ—Ä–∫–∞ nginx
nginx -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PM2
pm2 --version
```

## –ü–æ—Ä—è–¥–æ–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 1. –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ nginx
–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é: [SIMPLE_NGINX.md](./SIMPLE_NGINX.md)

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ**: nginx —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ (–ø–æ—Ä—Ç 80) —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ JavaScript –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä (–ø–æ—Ä—Ç 8080).

### 2. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ JavaScript –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞.

---

## –ó–∞–¥–∞—á–∞
–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ JavaScript, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ OpenAI API.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä—É

### 1. –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–ü–æ—Ä—Ç**: 8080 (–∏–ª–∏ –ª—é–±–æ–π —Å–≤–æ–±–æ–¥–Ω—ã–π)
- **–¶–µ–ª—å**: https://api.openai.com/v1
- **–§—É–Ω–∫—Ü–∏—è**: –ü—Ä–æ—Å—Ç–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
```
GET /status
–û—Ç–≤–µ—Ç: 200 OK —Å —Ç–µ–∫—Å—Ç–æ–º "OK"
```

#### –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ OpenAI
```
POST /chat/completions
GET /models
GET /models/{model}
```

### 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

#### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```json
{
  "express": "^4.18.2",
  "http-proxy-middleware": "^2.0.6",
  "cors": "^2.8.5"
}
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- CORS –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ü—Ä–æ—Å—Ç–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
PROXY_PORT=8080
TARGET_URL=https://api.openai.com/v1
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏
- `changeOrigin: true`
- `pathRewrite: { '^/': '/' }`
- –¢–∞–π–º–∞—É—Ç—ã: 60 —Å–µ–∫—É–Ω–¥
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
curl -I http://your-proxy-server:8080/status
```

#### –¢–µ—Å—Ç OpenAI —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏
```bash
curl -X POST http://your-proxy-server:8080/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_OPENAI_API_KEY" \
  -d '{
    "model": "gpt-3.5-turbo",
    "messages": [{"role": "user", "content": "Hello"}],
    "max_tokens": 100
  }'
```

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞, –æ–±–Ω–æ–≤–∏—Ç–µ `.env`:
```bash
NGINX_PROXY_URL=http://your-proxy-server:8080
USE_EXTERNAL_AI=false
```

### 7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:
- –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞
- –ú–µ—Ç–æ–¥ –∏ URL
- –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 8. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- 502 Bad Gateway ‚Üí –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ OpenAI
- 500 Internal Server Error ‚Üí –û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞
- 404 Not Found ‚Üí –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç

## –ö–æ–¥ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞

### 1. package.json
```json
{
  "name": "simple-proxy-server",
  "version": "1.0.0",
  "description": "–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä –¥–ª—è AI –∑–∞–ø—Ä–æ—Å–æ–≤",
  "main": "simple-proxy-server.js",
  "scripts": {
    "start": "node simple-proxy-server.js",
    "dev": "nodemon simple-proxy-server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "http-proxy-middleware": "^2.0.6",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  },
  "keywords": ["proxy", "openai", "api"],
  "author": "FZP Team",
  "license": "MIT"
}
```

### 2. simple-proxy-server.js
```javascript
const express = require('express');
const { createProxyMiddleware } = require('http-proxy-middleware');
const cors = require('cors');

const app = express();
const PORT = process.env.PROXY_PORT || 8080;

// Middleware
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
app.use((req, res, next) => {
    console.log(`${new Date().toISOString()} - ${req.method} ${req.url}`);
    next();
});

// –°—Ç–∞—Ç—É—Å —ç–Ω–¥–ø–æ–∏–Ω—Ç
app.get('/status', (req, res) => {
    res.status(200).send('OK\n');
});

// –ü—Ä–æ–∫—Å–∏ –¥–ª—è OpenAI API
app.use('/', createProxyMiddleware({
    target: 'https://api.openai.com/v1',
    changeOrigin: true,
    pathRewrite: {
        '^/': '/'
    },
    onProxyReq: (proxyReq, req, res) => {
        console.log(`–ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –Ω–∞: ${proxyReq.path}`);
    },
    onProxyRes: (proxyRes, req, res) => {
        console.log(`–û—Ç–≤–µ—Ç: ${proxyRes.statusCode}`);
    },
    onError: (err, req, res) => {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏:', err.message);
        res.status(500).send('–û—à–∏–±–∫–∞ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞');
    }
}));

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
app.use((err, req, res, next) => {
    console.error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:', err);
    res.status(500).send('–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
});

// –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
app.listen(PORT, () => {
    console.log(`üöÄ –ü—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É ${PORT}`);
    console.log(`üì° –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞: https://api.openai.com/v1`);
    console.log(`üîó –°—Ç–∞—Ç—É—Å: http://localhost:${PORT}/status`);
});

module.exports = app;
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
npm start

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev
```

## –ì–æ—Ç–æ–≤–æ! üéâ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ nginx –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–∫—Å–∏ —Å–µ—Ä–≤–µ—Ä–∞, –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –Ω–∏—Ö –±–µ–∑ 502 –æ—à–∏–±–æ–∫. 